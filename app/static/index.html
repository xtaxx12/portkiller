<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PortKiller - Port management and process control tool for developers">
    <title>PortKiller - Port Management Tool</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo">
                    <span class="logo-icon">üîå</span>
                    <h1>PortKiller</h1>
                    <span class="version-badge">v1.0.0</span>
                </div>
            </div>
            <div class="header-right">
                <div class="refresh-controls">
                    <label class="auto-refresh-toggle">
                        <input type="checkbox" id="autoRefresh" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">Auto-refresh</span>
                    </label>
                    <button class="btn btn-icon" id="refreshBtn" title="Refresh Now">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
                        </svg>
                    </button>
                </div>
                <div class="header-actions">
                    <!-- Theme Toggle -->
                    <button class="btn btn-icon" id="themeToggle" title="Toggle Theme">
                        <svg class="icon icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5"/>
                            <line x1="12" y1="1" x2="12" y2="3"/>
                            <line x1="12" y1="21" x2="12" y2="23"/>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                            <line x1="1" y1="12" x2="3" y2="12"/>
                            <line x1="21" y1="12" x2="23" y2="12"/>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                        </svg>
                        <svg class="icon icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </button>
                    <!-- Export Dropdown -->
                    <div class="dropdown" id="exportDropdown">
                        <button class="btn btn-icon" id="exportBtn" title="Export Data">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7 10 12 15 17 10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                        </button>
                        <div class="dropdown-menu" id="exportMenu">
                            <a href="/api/export/ports?format=json" class="dropdown-item">üìã Ports (JSON)</a>
                            <a href="/api/export/ports?format=csv" class="dropdown-item">üìä Ports (CSV)</a>
                            <div class="dropdown-divider"></div>
                            <a href="/api/export/logs?format=json" class="dropdown-item">üìã Logs (JSON)</a>
                            <a href="/api/export/logs?format=csv" class="dropdown-item">üìä Logs (CSV)</a>
                        </div>
                    </div>
                </div>
                <div class="last-update" id="lastUpdate">
                    <span class="pulse-dot"></span>
                    <span id="updateTime">--</span>
                </div>
            </div>
        </header>

        <!-- Stats Dashboard -->
        <section class="stats-dashboard">
            <div class="stat-card stat-tcp">
                <div class="stat-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value" id="tcpCount">--</span>
                    <span class="stat-label">TCP Ports</span>
                </div>
            </div>
            <div class="stat-card stat-udp">
                <div class="stat-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value" id="udpCount">--</span>
                    <span class="stat-label">UDP Ports</span>
                </div>
            </div>
            <div class="stat-card stat-listen">
                <div class="stat-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value" id="listenCount">--</span>
                    <span class="stat-label">Listening</span>
                </div>
            </div>
            <div class="stat-card stat-established">
                <div class="stat-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value" id="establishedCount">--</span>
                    <span class="stat-label">Established</span>
                </div>
            </div>
            <div class="stat-card stat-processes">
                <div class="stat-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                        <line x1="8" y1="21" x2="16" y2="21"/>
                        <line x1="12" y1="17" x2="12" y2="21"/>
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value" id="processCount">--</span>
                    <span class="stat-label">Processes</span>
                </div>
            </div>
        </section>

        <!-- Filters Section -->
        <section class="filters-section">
            <div class="search-container">
                <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                </svg>
                <input type="text" id="searchInput" placeholder="Search by port, process, or address..." class="search-input">
                <button class="btn btn-clear" id="clearSearch" title="Clear search">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="filter-chips">
                <button class="filter-chip active" data-filter="all">All</button>
                <button class="filter-chip" data-filter="tcp">TCP</button>
                <button class="filter-chip" data-filter="udp">UDP</button>
                <button class="filter-chip" data-filter="listen">LISTEN</button>
                <button class="filter-chip" data-filter="established">ESTABLISHED</button>
                <button class="filter-chip" data-filter="critical">‚ö†Ô∏è Critical</button>
            </div>
        </section>

        <!-- Ports Table -->
        <section class="table-section">
            <div class="table-container">
                <table class="ports-table" id="portsTable">
                    <thead>
                        <tr>
                            <th class="sortable" data-sort="port">
                                Port
                                <span class="sort-icon">‚Üï</span>
                            </th>
                            <th class="sortable" data-sort="protocol">
                                Protocol
                                <span class="sort-icon">‚Üï</span>
                            </th>
                            <th class="sortable" data-sort="state">
                                State
                                <span class="sort-icon">‚Üï</span>
                            </th>
                            <th>Local Address</th>
                            <th>Remote Address</th>
                            <th class="sortable" data-sort="pid">
                                PID
                                <span class="sort-icon">‚Üï</span>
                            </th>
                            <th class="sortable" data-sort="process_name">
                                Process
                                <span class="sort-icon">‚Üï</span>
                            </th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="portsTableBody">
                        <tr class="loading-row">
                            <td colspan="8">
                                <div class="loading-spinner"></div>
                                <span>Loading ports...</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="table-footer">
                <span class="results-count" id="resultsCount">-- results</span>
            </div>
        </section>

        <!-- Action Logs Drawer -->
        <aside class="logs-drawer" id="logsDrawer">
            <div class="drawer-header">
                <h2>üìã Action Logs</h2>
                <button class="btn btn-icon" id="closeDrawer">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="logs-content" id="logsContent">
                <p class="no-logs">No actions logged yet</p>
            </div>
        </aside>
        
        <button class="fab" id="logsToggle" title="View Action Logs">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
                <polyline points="10 9 9 9 8 9"/>
            </svg>
            <span class="fab-badge" id="logsBadge">0</span>
        </button>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal">
            <div class="modal-header">
                <h3>‚ö†Ô∏è Confirm Process Termination</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to terminate this process?</p>
                <div class="process-info" id="modalProcessInfo">
                    <div class="info-row">
                        <span class="info-label">Process:</span>
                        <span class="info-value" id="modalProcessName">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">PID:</span>
                        <span class="info-value" id="modalPid">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Port:</span>
                        <span class="info-value" id="modalPort">--</span>
                    </div>
                </div>
                <label class="force-kill-option">
                    <input type="checkbox" id="forceKill">
                    <span>Force terminate (SIGKILL) if normal terminate fails</span>
                </label>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelKill">Cancel</button>
                <button class="btn btn-danger" id="confirmKill">Terminate Process</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>
